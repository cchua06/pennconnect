<!DOCTYPE html>
<html>
<head>
    <title>Edit Profile</title>
</head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
<link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet"/>

<!--Include Bootstrap in imports-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>

<!--Multiple select script imports-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>

<!--Style for the navbar-->
<style>
* {box-sizing: border-box;}

/* Style the navbar */
.topnav {
    overflow: hidden;
    background-color: #e9e9e9;
}

/* Navbar links */
.topnav a {
    float: left;
    display: block;
    color: black;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
    font-size: 17px;
}

/* Navbar links on mouse-over */
.topnav a:hover {
    background-color: #ddd;
    color: black;
}

/* Active/current link */
.topnav a.active {
    background-color: #002058;
    color: white;
}

.topnav a.logout {
    background-color: #767676;
    color: white;
}

.topnav a.logout:hover {
    background-color: #222222;
    color: white;
}

.topnav .login-container button:hover {
    background: #ccc;
}

/* Add responsiveness - On small screens, display the navbar vertically instead of horizontally */
@media screen and (max-width: 600px) {
    .topnav .login-container {
    float: none;
    }
    .topnav a, .topnav input[type=text], .topnav .login-container button {
    float: none;
    display: block;
    text-align: left;
    width: 100%;
    margin: 0;
    padding: 14px;
    }
    .topnav input[type=text] {
    border: 1px solid #ccc;
    }
}

input {
    font-size: 12px;
}

button {
    background-color: #a9a9a9;
    font-size: 12px;
    border: 0px;
    color: black;
}

button:hover {
    background-color: #555555;
    color: white;
}
</style>

<script>
    function toggleEdit() {
        var inputs = document.querySelectorAll("input[readonly]");
        var textareas = document.querySelectorAll("textarea[readonly]");
        var editForm = document.getElementById("editForm");
        var buttons = document.getElementById("buttons");

        for (var i = 0; i < inputs.length; i++) {
            inputs[i].removeAttribute("readonly");
        }

        for (var i = 0; i < textareas.length; i++) {
            textareas[i].readOnly = false;
        }

        buttons.style.display = "block";

        if (document.getElementById("resume")) {
            document.getElementById("resumeInput").style.display = "block";
            document.getElementById("resumeView").style.display = "none";
        }

        if (document.getElementById("orgWebsiteView")) {
            document.getElementById("orgWebsiteInput").style.display= "block";
            document.getElementById("orgWebsiteView").style.display = "none";
        }
    }

    function discardChanges(event) {
        var discarded = confirm("Discard changes? (Yes/No)");
        event.preventDefault();
        if (discarded) {
            var editForm = document.getElementById("editForm");
            var buttons = document.getElementById("buttons");

            //document.getElementById("usernameInput").value = "<%= userId %>";
            document.getElementById("firstNameInput").value = "<%= data.firstName.S %>";
            document.getElementById("lastNameInput").value = "<%= data.lastName.S %>";
            
            if (document.getElementById("orgWebsiteInput")) {
                document.getElementById("orgWebsiteInput").style.display= "none";
                document.getElementById("orgWebsiteView").style.display = "block";
                document.getElementById("orgWebsiteInput").value = "<%= data.orgWebsite.S %>";
                document.getElementById("orgDescriptionInput").value = "<%= data.orgDescription.S %>";
                document.getElementById("orgWebsiteInput").setAttribute("readonly", "readonly");
                document.getElementById("orgDescriptionInput").setAttribute("readonly", "readonly");
            }

            if (document.getElementById("resume")) {
                document.getElementById("resumeInput").style.display = "none";
                document.getElementById("resumeView").style.display = "block";
            };

            //document.getElementById("usernameInput").setAttribute("readonly", "readonly");
            document.getElementById("firstNameInput").setAttribute("readonly", "readonly");
            document.getElementById("lastNameInput").setAttribute("readonly", "readonly");

            buttons.style.display = "none";
        }
    }
</script>

<!--Navigation Bar-->
<div class="topnav">
    <a class="font-weight-bold">PennConnect</a>
    <a class="active" href="/home" style="margin-left: 10px">Home</a>
    <a href="/connections">Connections</a>
    <a class="logout" href="/logOut" style="float:right">Log Out</a>
    <a style="float:right; margin-right: 10px; font-weight: bold" href="/profile"><%= userId %></a>
</div>

<body>
    <div class="align-items-center d-flex">
        <div class="col-12 text-center font-weight-bold" style="margin-top: 20px; font-size: 35px"><%= userId %>'s Page</div>
    </div>

    <div class="col-9 mt-3 pt-1 text-right" style="margin: 0 auto">
        <a href="javascript:void(0)" onclick="toggleEdit()">Edit</a>
    </div>
    <div class="pt-1 col-9 mt-1" style="margin: 0 auto; border: 2px solid #000; padding: 20px">
        <form id="editForm" enctype="multipart/form-data" method="post" action="/updateProfile">
            <!--
            <div class="row mb-3 mt-3 form-group">
                <a class="col-sm-6" style="font-weight: bold" title="username">Username:</a>
                <input name="userId" class="col-sm-6" type="text" id="usernameInput" value="<%= userId %>" readonly />
            </div>
            -->
            <div class="row mb-3 mt-3 form-group">
                <a class="col-sm-6" style="font-weight: bold" title="firstName">First Name:</a>
                <input name="firstName" class="col-sm-6" type="text" id="firstNameInput" value="<%= data.firstName.S %>" readonly />
            </div>
            <div class="row mb-3 form-group">
                <a class="col-sm-6" style="font-weight: bold" title="lastName">Last Name:</a>
                <input name="lastName" class="col-sm-6" type="text" id="lastNameInput" value="<%= data.lastName.S %>" readonly />
            </div>
            <div class="row mb-3 form-group">
                <a class="col-sm-6" style="font-weight: bold" title="userType">Account Type:</a>
                <span class="col-sm-6"><%= data.userType.S %></span>
            </div>
            <% if (resume) {%>
                <div class="row mb-3 form-group" id="resume">
                    <a class="col-sm-6" style="font-weight: bold" title="firstName">Resume:</a>
                    <a class="col-sm-6" id="resumeView" href=<%=resume%>>Download</a>
                    <input name="resumeInput" type="file" style="display: none" class="col-sm-6" id="resumeInput" accept=".pdf, .doc, .docx" style="display: none" />
                </div>
            <%}%>
            <% if (orgWebsite) {%>
                <div class="row mb-3 form-group">
                    <a class="col-sm-6" style="font-weight: bold" title="orgWebsite">Organization Website:</a>
                    <a class="col-sm-6" id="orgWebsiteView" href=<%=orgWebsite%>><%=orgWebsite%></a>
                    <input name="orgWebsite" class="col-sm-6" type="text" id="orgWebsiteInput" value="<%= data.orgWebsite.S %>" style="display: none" />
                </div>
                <div class="row mb-3 form-group">
                    <a class="col-sm-6" style="font-weight: bold" title="orgDescription">Organization Website:</a>
                    <textarea name="orgDescription" class="col-sm-6" id="orgDescriptionInput" rows="4" readonly><%= data.orgDescription.S %></textarea>
                </div>
            <%}%>
        <div id="buttons" style="display: none;">
            <button class="btn btn-primary" type="submit">Confirm Edits</button>
            <button class="btn btn-secondary" onclick="discardChanges(event)">Discard Changes</button>
        </div>
        </form>
    </div>
</body>